# Contributing guide

Thanks for lending a hand ðŸ‘‹

To understand how the code is structured, start with [`./src/index.js`](https://github.com/slevithan/oniguruma-to-es/blob/main/src/index.js), which exports the public API including `toRegExp`. If you have questions before starting development, feel free to open an issue.

## Setup

- [pnpm](https://pnpm.io/) is used to manage dependencies. Install it with `npm install --global pnpm`.
- Install dependencies with `pnpm install`.
- Build the package with `pnpm build`.

## Testing

- [Jasmine](https://jasmine.github.io/) is used to test the codebase. Run `pnpm test` to start the test runner.
- Tests live in `./spec`.
- Please include tests alongside changes and new features.

## Use in Shiki

This library receives extensive additional test coverage prior to new releases via the syntax highlighter [Shiki](https://github.com/shikijs/shiki). Shiki compares highlighting results for 220+ TextMate grammars (that include ~55k Oniguruma regexes) when using Oniguruma vs when using native JS regexes generated by this library.

- [Shiki's JS engine code](https://github.com/shikijs/shiki/blob/main/packages/engine-javascript/src/engine-compile.ts).
- [Script for comparing results](https://github.com/shikijs/shiki/blob/main/scripts/report-engine-js-compat.ts).
- [The generated report](https://shiki.style/references/engine-js-compat).

## Demo page

A demo REPL is included with this library and [available online](https://slevithan.github.io/oniguruma-to-es/demo/). It shows results as you type and can be helpful for quick manual testing, including trying out all of this library's options. Library functions can also be tested on the demo page via the developer console.

> [!IMPORTANT]
> The demo uses the latest published version of the library. To use local changes, you currently have to uncomment the relevant `<script>` tags in `./demo/index.html`. Run `pnpm build` to include your changes in the local bundle.

## Comparing results with Oniguruma

A [command line script](https://github.com/slevithan/oniguruma-to-es/blob/main/scripts/onig-match.js) is included for testing Oniguruma (via [vscode-oniguruma](https://github.com/microsoft/vscode-oniguruma)). It automatically compares results to the native JavaScript regexes generated by this library. See more details in the comment at the top of the script.
